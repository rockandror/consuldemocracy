<% if cookies.kind_of? ActionDispatch::Cookies::CookieJar %>
  <% if cookies && cookies['cookie_eu_consented'] != 'true' %>
    <div class="cookies-eu js-cookies-eu" <%= "dir=rtl" if I18n.exists?('cookies_eu.direction', I18n.locale) && I18n.t("cookies_eu.direction") == "rtl"  %>>
      <span class="cookies-eu-content-holder">
        <%= sanitize(t('cookies_eu.cookies_text', cookies_link: link_to(t("cookies_eu.cookies_link"), "/cookies"))) %>
      </span>
      <span class="cookies-eu-button-holder">
      <button class="cookies-eu-ok js-cookies-eu-ok"> <%= t('cookies_eu.ok') %> </button>
      <% if defined?(link).present? %>
        <a href="<%= link %>" class="cookies-eu-link" target="<%= defined?(target).present? ? target : '' %>"> <%= t('cookies_eu.learn_more') %> </a>
      <% end %>
      </span>
    </div>
    <script>
    document.addEventListener('cookies-eu-acknowledged', function() {
      $.ajax({
        url: "https://www.googletagmanager.com/gtag/js?id=G-9F2YV9XEJC",
        dataType: "script",
        success: () => {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('consent', {'analytics_storage': 'allowed'});
          gtag('config', 'G-9F2YV9XEJC');
        }
      });
    });
    </script>
  <% end %>
<% else %>
  <% raise Exception.new "'cookies' is a reserved Rails class, please rename your method" %>
<% end %>
